"use strict";Object.defineProperty(exports, "__esModule", {value: true});

var _chunkMA4BSN7Bcjs = require('../chunk-MA4BSN7B.cjs');
require('../chunk-HFPHOHB4.cjs');
require('../chunk-VIIXOUMH.cjs');
require('../chunk-DYR74CLD.cjs');
require('../chunk-GMRP5T42.cjs');



var _chunkW6GBV2JTcjs = require('../chunk-W6GBV2JT.cjs');
require('../chunk-4MZ45ISU.cjs');

// src/analyzer/queries/openapi.ts
function additionalProperties(definition) {
  return _chunkW6GBV2JTcjs.query.call(void 0, ["$..additionalProperties"], definition).map((res) => _chunkW6GBV2JTcjs.refizePointer.call(void 0, res.pointer));
}
function callbacks(definition) {
  return _chunkW6GBV2JTcjs.query.call(void 0, ["$.components.callbacks", "$.paths..callbacks"], definition).map((res) => _chunkW6GBV2JTcjs.refizePointer.call(void 0, res.pointer));
}
async function circularRefs(definition) {
  const oas = new (0, _chunkMA4BSN7Bcjs.Oas)(JSON.parse(JSON.stringify(definition)));
  await oas.dereference();
  const results = oas.getCircularReferences();
  results.sort();
  return results;
}
function discriminators(definition) {
  return _chunkW6GBV2JTcjs.query.call(void 0, ["$..discriminator"], definition).map((res) => _chunkW6GBV2JTcjs.refizePointer.call(void 0, res.pointer));
}
function links(definition) {
  return _chunkW6GBV2JTcjs.query.call(void 0, ["$..links"], definition).map((res) => _chunkW6GBV2JTcjs.refizePointer.call(void 0, res.pointer));
}
function mediaTypes(definition) {
  const results = Array.from(
    new Set(
      _chunkW6GBV2JTcjs.query.call(void 0, ["$..paths..content"], definition).map((res) => {
        return Object.keys(res.value);
      }).flat()
    )
  );
  results.sort();
  return results;
}
function parameterSerialization(definition) {
  return _chunkW6GBV2JTcjs.query.call(void 0, ["$..parameters[*].style^"], definition).map((res) => _chunkW6GBV2JTcjs.refizePointer.call(void 0, res.pointer));
}
function polymorphism(definition) {
  const results = Array.from(
    new Set(_chunkW6GBV2JTcjs.query.call(void 0, ["$..allOf^", "$..anyOf^", "$..oneOf^"], definition).map((res) => _chunkW6GBV2JTcjs.refizePointer.call(void 0, res.pointer)))
  );
  results.sort();
  return results;
}
function securityTypes(definition) {
  return Array.from(new Set(_chunkW6GBV2JTcjs.query.call(void 0, ["$.components.securitySchemes..type"], definition).map((res) => res.value)));
}
function serverVariables(definition) {
  return _chunkW6GBV2JTcjs.query.call(void 0, ["$.servers..variables^"], definition).map((res) => _chunkW6GBV2JTcjs.refizePointer.call(void 0, res.pointer));
}
function totalOperations(definition) {
  return _chunkW6GBV2JTcjs.query.call(void 0, ["$..paths[*]"], definition).map((res) => Object.keys(res.value)).flat().length;
}
function webhooks(definition) {
  return _chunkW6GBV2JTcjs.query.call(void 0, ["$.webhooks[*]"], definition).map((res) => _chunkW6GBV2JTcjs.refizePointer.call(void 0, res.pointer));
}
function xml(definition) {
  return _chunkW6GBV2JTcjs.query.call(void 0, 
    [
      "$.components.schemas..xml^",
      "$..parameters..xml^",
      "$..requestBody..xml^",
      "$..requestBody..['application/xml']",
      "$..requestBody..['application/xml-external-parsed-entity']",
      "$..requestBody..['application/xml-dtd']",
      "$..requestBody..['text/xml']",
      "$..requestBody..['text/xml-external-parsed-entity']",
      "$..requestBody.content[?(@property.match(/\\+xml$/i))]",
      "$..responses..['application/xml']",
      "$..responses..['application/xml-external-parsed-entity']",
      "$..responses..['application/xml-dtd']",
      "$..responses..['text/xml']",
      "$..responses..['text/xml-external-parsed-entity']",
      "$..responses[*].content[?(@property.match(/\\+xml$/i))]"
    ],
    definition
  ).map((res) => _chunkW6GBV2JTcjs.refizePointer.call(void 0, res.pointer));
}

// src/analyzer/queries/readme.ts
function authDefaults(definition) {
  return _chunkW6GBV2JTcjs.query.call(void 0, ["$.components.securitySchemes..['x-default']^"], definition).map((res) => _chunkW6GBV2JTcjs.refizePointer.call(void 0, res.pointer));
}
function codeSampleLanguages(definition) {
  const results = Array.from(
    new Set(
      _chunkW6GBV2JTcjs.query.call(void 0, ["$..['x-readme']['samples-languages']", "$..['x-samples-languages']"], definition).map((res) => res.value).reduce((prev, next) => prev.concat(next), [])
    )
  );
  results.sort();
  return results;
}
function codeSamplesDisabled(definition) {
  return Array.from(
    new Set(
      _chunkW6GBV2JTcjs.query.call(void 0, 
        [
          "$['x-samples-enabled']^",
          "$['x-readme']['samples-enabled']",
          "$..paths[*]..['x-samples-enabled']^",
          "$..paths[*]..['x-readme']['samples-enabled']^^"
        ],
        definition
      ).map((res) => _chunkW6GBV2JTcjs.refizePointer.call(void 0, res.pointer))
    )
  );
}
function corsProxyDisabled(definition) {
  return Array.from(
    new Set(
      _chunkW6GBV2JTcjs.query.call(void 0, 
        [
          "$['x-proxy-enabled']^",
          "$['x-readme']['proxy-enabled']",
          "$..paths[*]..['x-proxy-enabled']^",
          "$..paths[*]..['x-readme']['proxy-enabled']^^"
        ],
        definition
      ).map((res) => _chunkW6GBV2JTcjs.refizePointer.call(void 0, res.pointer))
    )
  );
}
function customCodeSamples(definition) {
  return _chunkW6GBV2JTcjs.query.call(void 0, ["$..['x-code-samples']", "$..['x-readme']['code-samples']"], definition).filter((res) => {
    return Array.isArray(res.value) && res.value.length ? res : false;
  }).map((res) => _chunkW6GBV2JTcjs.refizePointer.call(void 0, res.pointer));
}
function explorerDisabled(definition) {
  return _chunkW6GBV2JTcjs.query.call(void 0, 
    [
      "$['x-explorer-enabled']^",
      "$['x-readme']['explorer-enabled']",
      "$..paths[*]..['x-explorer-enabled']^",
      "$..paths[*]..['x-readme']['explorer-enabled']^^"
    ],
    definition
  ).map((res) => _chunkW6GBV2JTcjs.refizePointer.call(void 0, res.pointer));
}
function rawBody(definition) {
  return _chunkW6GBV2JTcjs.query.call(void 0, ["$..RAW_BODY^^"], definition).map((res) => _chunkW6GBV2JTcjs.refizePointer.call(void 0, res.pointer));
}
function staticHeaders(definition) {
  return _chunkW6GBV2JTcjs.query.call(void 0, ["$..['x-headers']", "$..['x-readme']['headers']"], definition).filter((res) => {
    return Array.isArray(res.value) && res.value.length ? res : false;
  }).map((res) => _chunkW6GBV2JTcjs.refizePointer.call(void 0, res.pointer));
}

// src/analyzer/index.ts
async function analyzer(definition) {
  const additionalProperties2 = additionalProperties(definition);
  const callbacks2 = callbacks(definition);
  const circularRefs2 = await circularRefs(definition);
  const discriminators2 = discriminators(definition);
  const links2 = links(definition);
  const parameterSerialization2 = parameterSerialization(definition);
  const polymorphism2 = polymorphism(definition);
  const serverVariables2 = serverVariables(definition);
  const webhooks2 = webhooks(definition);
  const xml2 = xml(definition);
  const authDefaults2 = authDefaults(definition);
  const codeSampleLanguages2 = codeSampleLanguages(definition);
  const customCodeSamples2 = customCodeSamples(definition);
  const codeSamplesDisabled2 = codeSamplesDisabled(definition);
  const disabledCorsProxy = corsProxyDisabled(definition);
  const explorerDisabled2 = explorerDisabled(definition);
  const staticHeaders2 = staticHeaders(definition);
  const rawBody2 = rawBody(definition);
  const analysis = {
    general: {
      mediaTypes: {
        name: "Media Type",
        found: mediaTypes(definition)
      },
      operationTotal: {
        name: "Operation",
        found: totalOperations(definition)
      },
      securityTypes: {
        name: "Security Type",
        found: securityTypes(definition)
      }
    },
    openapi: {
      additionalProperties: {
        present: !!additionalProperties2.length,
        locations: additionalProperties2
      },
      callbacks: {
        present: !!callbacks2.length,
        locations: callbacks2
      },
      circularRefs: {
        present: !!circularRefs2.length,
        locations: circularRefs2
      },
      discriminators: {
        present: !!discriminators2.length,
        locations: discriminators2
      },
      links: {
        present: !!links2.length,
        locations: links2
      },
      style: {
        present: !!parameterSerialization2.length,
        locations: parameterSerialization2
      },
      polymorphism: {
        present: !!polymorphism2.length,
        locations: polymorphism2
      },
      serverVariables: {
        present: !!serverVariables2.length,
        locations: serverVariables2
      },
      webhooks: {
        present: !!webhooks2.length,
        locations: webhooks2
      },
      xml: {
        present: !!xml2.length,
        locations: xml2
      }
    },
    readme: {
      "x-default": {
        present: !!authDefaults2.length,
        locations: authDefaults2
      },
      "x-readme.code-samples": {
        present: !!customCodeSamples2.length,
        locations: customCodeSamples2
      },
      "x-readme.headers": {
        present: !!staticHeaders2.length,
        locations: staticHeaders2
      },
      "x-readme.explorer-enabled": {
        present: !!explorerDisabled2.length,
        locations: explorerDisabled2
      },
      "x-readme.proxy-enabled": {
        present: !!disabledCorsProxy.length,
        locations: disabledCorsProxy
      },
      "x-readme.samples-languages": {
        present: !!codeSampleLanguages2.length,
        locations: codeSampleLanguages2
      }
    }
  };
  if (codeSamplesDisabled2.length) {
    analysis.readme["x-readme.samples-enabled"] = {
      present: !!codeSamplesDisabled2.length,
      locations: codeSamplesDisabled2
    };
  }
  if (rawBody2.length) {
    analysis.readme.raw_body = {
      present: !!rawBody2.length,
      locations: rawBody2
    };
  }
  return analysis;
}


exports.default = analyzer;

module.exports = exports.default//# sourceMappingURL=index.cjs.map